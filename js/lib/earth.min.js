function Earth(e){var l,i={50:{SGWorld:"CLSID:3a4f9191-65a8-11d5-85c1-0001023952c1"},65:{TerraExplorer3DWindow:"CLSID:3a4f9192-65a8-11d5-85c1-0001023952c1",TerraExplorerInformationTree:"CLSID:3a4f9193-65a8-11d5-85c1-0001023952c1",TerraExplorerNavigationMap:"CLSID:3a4f9194-65a8-11d5-85c1-0001023952c1",TerraExplorer3DWindowEx:"CLSID:3a4f9196-65a8-11d5-85c1-0001023952c1",SGWorld:"CLSID:3A4F9199-65A8-11D5-85C1-0001023952C1"},66:{TerraExplorer3DWindow:"CLSID:3a4f9192-65a8-11d5-85c1-0001023952c1",TerraExplorerInformationTree:"CLSID:3a4f9193-65a8-11d5-85c1-0001023952c1",TerraExplorerNavigationMap:"CLSID:3a4f9194-65a8-11d5-85c1-0001023952c1",TerraExplorer3DWindowEx:"CLSID:3a4f9196-65a8-11d5-85c1-0001023952c1",SGWorld:"CLSID:3A4F9199-65A8-11D5-85C1-0001023952C1"},70:{TerraExplorer3DWindow:"CLSID:3a4f9192-65a8-11d5-85c1-0001023952c1",TerraExplorerInformationTree:"CLSID:3a4f9193-65a8-11d5-85c1-0001023952c1",TerraExplorerNavigationMap:"CLSID:3a4f9194-65a8-11d5-85c1-0001023952c1",TerraExplorer3DWindowEx:"CLSID:3a4f9196-65a8-11d5-85c1-0001023952c1",SGWorld:"CLSID:3A4F919C-65A8-11D5-85C1-0001023952C1"}},s=function(e){e&&l&&l(r())},u=function(e,r){r=i[r]?r:"70";var t=document.getElementById("TE3DWindow"),n=S();if(!t){if((t=document.createElement("object")).setAttribute("id","TE3DWindow"),t.setAttribute("name","TE3DWindow"),t.setAttribute("width","100%"),t.setAttribute("height","100%"),"Chrome"==n.type||"Firefox"==n.type)t.setAttribute("type","application/x-skyline"),t.setAttribute("clsid",i[r].TerraExplorer3DWindow);else{if("MSIE"!=n.type)return null;t.setAttribute("classid",i[r].TerraExplorer3DWindow)}document.getElementById(e)?document.getElementById(e).appendChild(t):document.body.appendChild(t)}return t},p=function(e,r,t){r=i[r]?r:"70";var n=document.getElementById("SGWorld");if(!n){if((n=document.createElement("object")).setAttribute("id","SGWorld"),n.setAttribute("name","SGWorld"),"Chrome"==t.type||"Firefox"==t.type)n.setAttribute("type","application/x-skyline"),n.setAttribute("clsid",i[r].SGWorld);else{if("MSIE"!=t.type)return null;n.setAttribute("classid",i[r].SGWorld)}n.setAttribute("style","display:none;height:0px"),document.getElementById(e)?document.getElementById(e).appendChild(n):document.body.appendChild(n)}return n},r=function(){var e=document.getElementById("SGWorld");return e||((e=document.createElement("object")).name="SGWorld",e.id="SGWorld",e.classid="CLSID:3a4f9199-65a8-11d5-85c1-0001023952c1",document.body.appendChild(e)),e},f=function(e){var r=e.Version.Build,t=e.Version.Freeze,n=e.Version.Major,i=e.Version.Minor,o=e.Version.Type,a={};return a.type=o,a.version=n+"."+i+"."+r,a.freeze=t,a.is32BitApp=parseFloat(a.version)<=6.6,a},m=function(){return!!(window.ActiveXObject||"ActiveXObject"in window)},S=function(){var e,r,t,n={},i=(e=window.navigator,r=e.platform,t=e.userAgent,m()?window.XMLHttpRequest?"MSIE/7.0plus"+r:"MSIE/6.0"+r:(res=t.match(/Chrome\/([\d.]+)/g))?res[0]+r:(res=t.match(/Firefox\/([\d.]+)/g))?res[0]+r:(res=t.match(/Opera\/([\d.]+)/g))?res[0]+r:(res=t.match(/Safari\/([\d.]+)/g))?res[0]+r:"");return n.version=o(i)-0,n.type=i.split("/")[0],n.win32=0<i.indexOf("Win32"),n},o=function(e){return null==e?0:parseFloat(e.match(/[\d.]+/g)[0])},t=e;this.inital=function(){!function(e,r,t,n){m()||uniqueIDs_NotIE();var i=S(),o=u(e,r),a=p(e,r,i),d={};try{d=f(a)}catch(e){return alert("三维控件实例化失败")}if(d.version)try{if(d.is32BitApp&&i.win32||!d.is32BitApp&&!i.win32){if(a.AttachEvent("OnLoadFinished",s),o.BorderStyle=0,n.server.isuse&&n.server.url){var c=JSON.parse(window.atob(n.token));a.SGServer.Connect(n.server.url,c.username,c.password),setInterval(function(){a.SGServer.Reconnect()},18e5)}l=t,a.Project.Open(n.fly,!0)}else alert("当前浏览器位数与三维控件不匹配")}catch(e){alert(e.message)}}(t.container,t.version,t.callback,t)},this.getEarth=r}